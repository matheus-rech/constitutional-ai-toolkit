<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Constitutional AI & Value Discovery - Interactive Explorer</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, #1e3a8a 0%, #7c3aed 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .subtitle {
            font-size: 1.2rem;
            opacity: 0.95;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .tab {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid rgba(255,255,255,0.3);
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s;
        }

        .tab:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }

        .tab.active {
            background: white;
            color: #1e3a8a;
            border-color: white;
        }

        .content-card {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            margin-bottom: 30px;
        }

        h2 {
            color: #1e3a8a;
            margin-bottom: 20px;
            font-size: 1.8rem;
        }

        h3 {
            color: #7c3aed;
            margin-top: 25px;
            margin-bottom: 15px;
            font-size: 1.4rem;
        }

        .simulation-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .sim-card {
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            padding: 20px;
            transition: all 0.3s;
            cursor: pointer;
        }

        .sim-card:hover {
            border-color: #7c3aed;
            box-shadow: 0 5px 15px rgba(124, 58, 237, 0.2);
            transform: translateY(-3px);
        }

        .sim-card.selected {
            border-color: #7c3aed;
            background: #f5f3ff;
        }

        .sim-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #1e3a8a;
            margin-bottom: 10px;
        }

        .sim-description {
            color: #64748b;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .sim-tags {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .tag {
            background: #ddd6fe;
            color: #5b21b6;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 500;
        }

        .tag.pro {
            background: #dcfce7;
            color: #166534;
        }

        .tag.con {
            background: #fee2e2;
            color: #991b1b;
        }

        .interactive-demo {
            background: #f8fafc;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }

        .controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .control-group {
            flex: 1;
            min-width: 200px;
        }

        label {
            display: block;
            font-weight: 600;
            color: #475569;
            margin-bottom: 8px;
            font-size: 0.9rem;
        }

        input[type="range"] {
            width: 100%;
            height: 6px;
            border-radius: 5px;
            background: #e2e8f0;
            outline: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #7c3aed;
            cursor: pointer;
        }

        select {
            width: 100%;
            padding: 10px;
            border: 2px solid #e2e8f0;
            border-radius: 6px;
            font-size: 1rem;
            background: white;
        }

        button {
            background: linear-gradient(135deg, #7c3aed 0%, #1e3a8a 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(124, 58, 237, 0.4);
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .visualization {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            min-height: 400px;
        }

        canvas {
            max-width: 100%;
            height: auto !important;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .stat-box {
            background: #f8fafc;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border: 2px solid #e2e8f0;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: #7c3aed;
            display: block;
        }

        .stat-label {
            color: #64748b;
            font-size: 0.9rem;
            margin-top: 5px;
        }

        .code-block {
            background: #1e293b;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            overflow-x: auto;
            margin-top: 15px;
        }

        .code-comment {
            color: #94a3b8;
        }

        .code-keyword {
            color: #c084fc;
        }

        .code-function {
            color: #fbbf24;
        }

        .code-string {
            color: #86efac;
        }

        .framework-comparison {
            margin-top: 30px;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        .comparison-table th {
            background: #7c3aed;
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 600;
        }

        .comparison-table td {
            padding: 12px;
            border-bottom: 1px solid #e2e8f0;
        }

        .comparison-table tr:hover {
            background: #f8fafc;
        }

        .checkmark {
            color: #22c55e;
            font-weight: bold;
        }

        .xmark {
            color: #ef4444;
            font-weight: bold;
        }

        .info-box {
            background: #eff6ff;
            border-left: 4px solid #3b82f6;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .warning-box {
            background: #fef3c7;
            border-left: 4px solid #f59e0b;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .success-box {
            background: #dcfce7;
            border-left: 4px solid #22c55e;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
            }

            .tabs {
                flex-direction: column;
            }

            .tab {
                width: 100%;
            }

            .simulation-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // Main Application Component
        function App() {
            const [activeTab, setActiveTab] = useState('overview');

            return (
                <div className="container">
                    <header>
                        <h1>üèõÔ∏è Constitutional AI & Value Discovery</h1>
                        <p className="subtitle">Interactive Explorer: From Simulation to Society</p>
                    </header>

                    <div className="tabs">
                        <button
                            className={`tab ${activeTab === 'overview' ? 'active' : ''}`}
                            onClick={() => setActiveTab('overview')}
                        >
                            üìö Overview
                        </button>
                        <button
                            className={`tab ${activeTab === 'simulations' ? 'active' : ''}`}
                            onClick={() => setActiveTab('simulations')}
                        >
                            üé≤ Simulation Types
                        </button>
                        <button
                            className={`tab ${activeTab === 'abm' ? 'active' : ''}`}
                            onClick={() => setActiveTab('abm')}
                        >
                            ü§ñ Agent-Based Demo
                        </button>
                        <button
                            className={`tab ${activeTab === 'monte-carlo' ? 'active' : ''}`}
                            onClick={() => setActiveTab('monte-carlo')}
                        >
                            üéØ Monte Carlo Demo
                        </button>
                        <button
                            className={`tab ${activeTab === 'comparison' ? 'active' : ''}`}
                            onClick={() => setActiveTab('comparison')}
                        >
                            üìä Framework Comparison
                        </button>
                        <button
                            className={`tab ${activeTab === 'code' ? 'active' : ''}`}
                            onClick={() => setActiveTab('code')}
                        >
                            üíª Code Examples
                        </button>
                    </div>

                    {activeTab === 'overview' && <OverviewTab />}
                    {activeTab === 'simulations' && <SimulationsTab />}
                    {activeTab === 'abm' && <ABMDemo />}
                    {activeTab === 'monte-carlo' && <MonteCarloDemo />}
                    {activeTab === 'comparison' && <ComparisonTab />}
                    {activeTab === 'code' && <CodeExamplesTab />}
                </div>
            );
        }

        // Overview Tab
        function OverviewTab() {
            return (
                <div className="content-card">
                    <h2>üåç Can Countries Have Constitutional AI?</h2>

                    <div className="info-box">
                        <strong>Key Insight:</strong> Yes! Countries can develop AI systems governed by their constitutional frameworks and legal principles - creating "national constitutional AI" distinct from Anthropic's approach.
                    </div>

                    <h3>Two Types of Constitutional AI</h3>

                    <div className="simulation-grid">
                        <div className="sim-card">
                            <div className="sim-title">üè¢ Anthropic's Constitutional AI</div>
                            <div className="sim-description">
                                A training framework that uses a "constitution" (set of principles) to make AI helpful, harmless, and honest without constant human labeling.
                            </div>
                            <div className="sim-tags">
                                <span className="tag pro">Scalable</span>
                                <span className="tag pro">Transparent</span>
                                <span className="tag">Company-defined</span>
                            </div>
                        </div>

                        <div className="sim-card">
                            <div className="sim-title">üèõÔ∏è National Constitutional AI</div>
                            <div className="sim-description">
                                AI systems aligned with a country's actual legal constitution and democratic values, used for governance and public services.
                            </div>
                            <div className="sim-tags">
                                <span className="tag pro">Democratic</span>
                                <span className="tag pro">Legally binding</span>
                                <span className="tag">Culture-specific</span>
                            </div>
                        </div>
                    </div>

                    <h3>üî¨ How New Values Are Discovered</h3>

                    <p style={{lineHeight: '1.8', color: '#334155', marginTop: '15px'}}>
                        Value discovery isn't just about simulation - it's a hybrid process combining:
                    </p>

                    <div className="stats-grid">
                        <div className="stat-box">
                            <span className="stat-value">üé≤</span>
                            <span className="stat-label">Simulation Models</span>
                        </div>
                        <div className="stat-box">
                            <span className="stat-value">üë•</span>
                            <span className="stat-label">Human Experience</span>
                        </div>
                        <div className="stat-box">
                            <span className="stat-value">üß†</span>
                            <span className="stat-label">Philosophical Reasoning</span>
                        </div>
                        <div className="stat-box">
                            <span className="stat-value">üó≥Ô∏è</span>
                            <span className="stat-label">Democratic Deliberation</span>
                        </div>
                    </div>

                    <div className="success-box" style={{marginTop: '30px'}}>
                        <strong>Best Practice:</strong> Use AI simulations to generate scenarios and model consequences, but always have humans make the final value judgments through democratic processes.
                    </div>

                    <h3>üéØ Constitutional Sandbox Proposal</h3>

                    <p style={{lineHeight: '1.8', color: '#334155', marginTop: '15px'}}>
                        Countries could run virtual constitutional experiments:
                    </p>

                    <ol style={{lineHeight: '2', color: '#334155', marginLeft: '20px', marginTop: '15px'}}>
                        <li>AI simulates society under different constitutional values</li>
                        <li>Citizens participate in simulated scenarios</li>
                        <li>Measure outcomes (happiness, stability, innovation, justice)</li>
                        <li>Democratic vote on which values to adopt</li>
                        <li>Gradual real-world implementation with continuous monitoring</li>
                    </ol>
                </div>
            );
        }

        // Simulations Tab
        function SimulationsTab() {
            const [selectedSim, setSelectedSim] = useState(null);

            const simulations = [
                {
                    id: 'monte-carlo',
                    title: 'Monte Carlo Simulation',
                    description: 'Random sampling for uncertainty quantification and risk assessment',
                    pros: ['Fast', 'Good for uncertainty', 'Easy to implement'],
                    cons: ['Limited behavior modeling', 'No emergent phenomena', 'Assumes known distributions'],
                    bestFor: 'Risk assessment, policy evaluation with uncertainty',
                    complexity: 'Low'
                },
                {
                    id: 'abm',
                    title: 'Agent-Based Modeling (ABM)',
                    description: 'Individual agents with behaviors creating emergent social phenomena',
                    pros: ['Emergent behavior', 'Realistic dynamics', 'Shows how values spread'],
                    cons: ['Computationally expensive', 'Calibration difficult', 'Many parameters'],
                    bestFor: 'Value discovery, social dynamics, policy impact',
                    complexity: 'High'
                },
                {
                    id: 'system-dynamics',
                    title: 'System Dynamics',
                    description: 'Stock-and-flow models of feedback loops and long-term trends',
                    pros: ['Macro perspective', 'Feedback loops', 'Long-term trends'],
                    cons: ['Aggregated view', 'Misses individual variation', 'Requires domain knowledge'],
                    bestFor: 'Policy delays, societal trends, macro analysis',
                    complexity: 'Medium'
                },
                {
                    id: 'marl',
                    title: 'Multi-Agent RL',
                    description: 'Agents learn optimal strategies through reinforcement learning',
                    pros: ['Finds equilibria', 'Strategic behavior', 'Novel solutions'],
                    cons: ['Very complex', 'Training intensive', 'Black box'],
                    bestFor: 'Strategic interactions, Nash equilibria, game theory',
                    complexity: 'Very High'
                },
                {
                    id: 'evolutionary',
                    title: 'Evolutionary Algorithms',
                    description: 'Evolving populations of solutions through selection and mutation',
                    pros: ['Discovers novelty', 'Optimization', 'Parallel search'],
                    cons: ['Can get stuck', 'Slow convergence', 'Fitness function critical'],
                    bestFor: 'Value optimization, novel right discovery, exploring space',
                    complexity: 'Medium'
                },
                {
                    id: 'causal',
                    title: 'Causal Inference',
                    description: 'Understanding cause-effect relationships and counterfactuals',
                    pros: ['Mechanisms', 'Counterfactuals', 'Why questions'],
                    cons: ['Need good data', 'Assumption heavy', 'Not predictive'],
                    bestFor: 'Understanding why, mechanism discovery, what-if analysis',
                    complexity: 'High'
                }
            ];

            return (
                <div className="content-card">
                    <h2>üé≤ Simulation Methodologies for Value Discovery</h2>

                    <div className="warning-box">
                        <strong>Important:</strong> No single simulation type is sufficient. Best practice is to use an ensemble of multiple methods for robust predictions.
                    </div>

                    <div className="simulation-grid">
                        {simulations.map(sim => (
                            <div
                                key={sim.id}
                                className={`sim-card ${selectedSim?.id === sim.id ? 'selected' : ''}`}
                                onClick={() => setSelectedSim(sim)}
                            >
                                <div className="sim-title">{sim.title}</div>
                                <div className="sim-description">{sim.description}</div>
                                <div className="sim-tags">
                                    <span className="tag">{sim.complexity} Complexity</span>
                                </div>
                            </div>
                        ))}
                    </div>

                    {selectedSim && (
                        <div className="interactive-demo">
                            <h3>{selectedSim.title} - Details</h3>

                            <div style={{marginTop: '20px'}}>
                                <h4 style={{color: '#22c55e', marginBottom: '10px'}}>‚úì Strengths</h4>
                                <ul style={{lineHeight: '2', color: '#334155', marginLeft: '20px'}}>
                                    {selectedSim.pros.map((pro, i) => (
                                        <li key={i}>{pro}</li>
                                    ))}
                                </ul>
                            </div>

                            <div style={{marginTop: '20px'}}>
                                <h4 style={{color: '#ef4444', marginBottom: '10px'}}>‚úó Limitations</h4>
                                <ul style={{lineHeight: '2', color: '#334155', marginLeft: '20px'}}>
                                    {selectedSim.cons.map((con, i) => (
                                        <li key={i}>{con}</li>
                                    ))}
                                </ul>
                            </div>

                            <div className="info-box" style={{marginTop: '20px'}}>
                                <strong>Best Used For:</strong> {selectedSim.bestFor}
                            </div>
                        </div>
                    )}

                    <div className="success-box" style={{marginTop: '30px'}}>
                        <strong>Recommended Ensemble:</strong> ABM (core) + Monte Carlo (uncertainty) + Causal Models (mechanisms) + System Dynamics (macro trends)
                    </div>
                </div>
            );
        }

        // Agent-Based Model Demo
        function ABMDemo() {
            const canvasRef = useRef(null);
            const [isRunning, setIsRunning] = useState(false);
            const [agents, setAgents] = useState([]);
            const [iteration, setIteration] = useState(0);
            const [stats, setStats] = useState({ privacy: 0, security: 0, freedom: 0 });
            const [policyLevel, setPolicyLevel] = useState(50);
            const animationRef = useRef(null);

            // Initialize agents
            const initializeAgents = () => {
                const newAgents = [];
                for (let i = 0; i < 100; i++) {
                    newAgents.push({
                        id: i,
                        x: Math.random() * 600,
                        y: Math.random() * 400,
                        values: {
                            privacy: 0.5 + Math.random() * 0.3,
                            security: 0.5 + Math.random() * 0.3,
                            freedom: 0.5 + Math.random() * 0.3
                        },
                        connections: []
                    });
                }

                // Create social network
                newAgents.forEach(agent => {
                    const numConnections = 3 + Math.floor(Math.random() * 5);
                    for (let i = 0; i < numConnections; i++) {
                        const otherId = Math.floor(Math.random() * newAgents.length);
                        if (otherId !== agent.id && !agent.connections.includes(otherId)) {
                            agent.connections.push(otherId);
                        }
                    }
                });

                setAgents(newAgents);
                setIteration(0);
            };

            useEffect(() => {
                initializeAgents();
            }, []);

            // Simulation step
            const simulationStep = () => {
                setAgents(prevAgents => {
                    const newAgents = [...prevAgents];
                    const policy = policyLevel / 100;

                    newAgents.forEach(agent => {
                        // Policy impact
                        if (Math.random() < policy) {
                            agent.values.privacy -= 0.01;
                            agent.values.security += 0.01;
                        }

                        // Social influence
                        agent.connections.forEach(connId => {
                            if (connId < newAgents.length) {
                                const other = newAgents[connId];
                                agent.values.privacy += (other.values.privacy - agent.values.privacy) * 0.05;
                                agent.values.security += (other.values.security - agent.values.security) * 0.05;
                                agent.values.freedom += (other.values.freedom - agent.values.freedom) * 0.05;
                            }
                        });

                        // Normalize
                        const total = agent.values.privacy + agent.values.security + agent.values.freedom;
                        agent.values.privacy /= total;
                        agent.values.security /= total;
                        agent.values.freedom /= total;
                    });

                    return newAgents;
                });

                setIteration(prev => prev + 1);
            };

            // Calculate stats
            useEffect(() => {
                if (agents.length > 0) {
                    const avgPrivacy = agents.reduce((sum, a) => sum + a.values.privacy, 0) / agents.length;
                    const avgSecurity = agents.reduce((sum, a) => sum + a.values.security, 0) / agents.length;
                    const avgFreedom = agents.reduce((sum, a) => sum + a.values.freedom, 0) / agents.length;
                    setStats({
                        privacy: (avgPrivacy * 100).toFixed(1),
                        security: (avgSecurity * 100).toFixed(1),
                        freedom: (avgFreedom * 100).toFixed(1)
                    });
                }
            }, [agents]);

            // Draw agents
            useEffect(() => {
                if (canvasRef.current && agents.length > 0) {
                    const canvas = canvasRef.current;
                    const ctx = canvas.getContext('2d');

                    // Clear
                    ctx.fillStyle = '#f8fafc';
                    ctx.fillRect(0, 0, canvas.width, canvas.height);

                    // Draw connections
                    ctx.strokeStyle = '#e2e8f0';
                    ctx.lineWidth = 1;
                    agents.forEach(agent => {
                        agent.connections.forEach(connId => {
                            if (connId < agents.length) {
                                const other = agents[connId];
                                ctx.beginPath();
                                ctx.moveTo(agent.x, agent.y);
                                ctx.lineTo(other.x, other.y);
                                ctx.stroke();
                            }
                        });
                    });

                    // Draw agents
                    agents.forEach(agent => {
                        const privacy = agent.values.privacy;
                        const security = agent.values.security;
                        const freedom = agent.values.freedom;

                        // Color based on dominant value
                        let color;
                        if (privacy > security && privacy > freedom) {
                            color = `rgba(59, 130, 246, ${0.5 + privacy * 0.5})`;
                        } else if (security > freedom) {
                            color = `rgba(239, 68, 68, ${0.5 + security * 0.5})`;
                        } else {
                            color = `rgba(34, 197, 94, ${0.5 + freedom * 0.5})`;
                        }

                        ctx.fillStyle = color;
                        ctx.beginPath();
                        ctx.arc(agent.x, agent.y, 5, 0, Math.PI * 2);
                        ctx.fill();
                    });
                }
            }, [agents]);

            // Animation loop
            useEffect(() => {
                if (isRunning) {
                    animationRef.current = setInterval(() => {
                        simulationStep();
                    }, 100);
                } else {
                    if (animationRef.current) {
                        clearInterval(animationRef.current);
                    }
                }

                return () => {
                    if (animationRef.current) {
                        clearInterval(animationRef.current);
                    }
                };
            }, [isRunning, policyLevel]);

            return (
                <div className="content-card">
                    <h2>ü§ñ Agent-Based Model: Value Evolution</h2>

                    <div className="info-box">
                        <strong>Scenario:</strong> 100 citizens with initial value preferences for Privacy (blue), Security (red), and Freedom (green). A surveillance policy affects their values, which also spread through social networks.
                    </div>

                    <div className="controls">
                        <div className="control-group">
                            <label>Surveillance Policy Level: {policyLevel}%</label>
                            <input
                                type="range"
                                min="0"
                                max="100"
                                value={policyLevel}
                                onChange={(e) => setPolicyLevel(parseInt(e.target.value))}
                            />
                        </div>
                    </div>

                    <div style={{display: 'flex', gap: '15px', marginBottom: '20px'}}>
                        <button onClick={() => setIsRunning(!isRunning)}>
                            {isRunning ? '‚è∏ Pause' : '‚ñ∂Ô∏è Run'}
                        </button>
                        <button onClick={initializeAgents}>üîÑ Reset</button>
                    </div>

                    <div className="visualization">
                        <canvas ref={canvasRef} width="600" height="400" />
                        <div style={{textAlign: 'center', marginTop: '10px', color: '#64748b'}}>
                            Iteration: {iteration} | Blue = Privacy | Red = Security | Green = Freedom
                        </div>
                    </div>

                    <div className="stats-grid">
                        <div className="stat-box">
                            <span className="stat-value" style={{color: '#3b82f6'}}>{stats.privacy}%</span>
                            <span className="stat-label">Avg Privacy Value</span>
                        </div>
                        <div className="stat-box">
                            <span className="stat-value" style={{color: '#ef4444'}}>{stats.security}%</span>
                            <span className="stat-label">Avg Security Value</span>
                        </div>
                        <div className="stat-box">
                            <span className="stat-value" style={{color: '#22c55e'}}>{stats.freedom}%</span>
                            <span className="stat-label">Avg Freedom Value</span>
                        </div>
                    </div>

                    <div className="success-box" style={{marginTop: '20px'}}>
                        <strong>What to observe:</strong> As you increase surveillance policy, privacy values decrease and security values increase. Values also spread through social networks, creating clusters of similar beliefs.
                    </div>
                </div>
            );
        }

        // Monte Carlo Demo
        function MonteCarloDemo() {
            const chartRef = useRef(null);
            const [runs, setRuns] = useState(1000);
            const [ubiAmount, setUbiAmount] = useState(1000);
            const [results, setResults] = useState(null);
            const [isRunning, setIsRunning] = useState(false);
            const chartInstanceRef = useRef(null);

            const runSimulation = () => {
                setIsRunning(true);

                setTimeout(() => {
                    const outcomes = [];

                    for (let i = 0; i < runs; i++) {
                        // Random parameters
                        const inflation = 0.02 + Math.random() * 0.13; // 2-15%
                        const laborParticipation = 0.6 + Math.random() * 0.3; // 60-90%
                        const productivityGain = -0.05 + Math.random() * 0.15; // -5% to +10%

                        // Simple economic model
                        const gdpImpact = (laborParticipation - 0.75) * 2 + productivityGain;
                        const povertyReduction = Math.min(40, (ubiAmount / 50) * (1 - inflation));
                        const inflation_final = inflation + (ubiAmount / 10000) * 0.5;

                        outcomes.push({
                            gdp: gdpImpact,
                            poverty: povertyReduction,
                            inflation: inflation_final * 100
                        });
                    }

                    // Calculate statistics
                    const gdpValues = outcomes.map(o => o.gdp);
                    const povertyValues = outcomes.map(o => o.poverty);
                    const inflationValues = outcomes.map(o => o.inflation);

                    const stats = {
                        gdp: {
                            mean: gdpValues.reduce((a, b) => a + b) / gdpValues.length,
                            p5: gdpValues.sort((a, b) => a - b)[Math.floor(runs * 0.05)],
                            p95: gdpValues.sort((a, b) => a - b)[Math.floor(runs * 0.95)]
                        },
                        poverty: {
                            mean: povertyValues.reduce((a, b) => a + b) / povertyValues.length,
                            p5: povertyValues.sort((a, b) => a - b)[Math.floor(runs * 0.05)],
                            p95: povertyValues.sort((a, b) => a - b)[Math.floor(runs * 0.95)]
                        },
                        inflation: {
                            mean: inflationValues.reduce((a, b) => a + b) / inflationValues.length,
                            p5: inflationValues.sort((a, b) => a - b)[Math.floor(runs * 0.05)],
                            p95: inflationValues.sort((a, b) => a - b)[Math.floor(runs * 0.95)]
                        }
                    };

                    setResults(stats);

                    // Create histogram
                    const ctx = chartRef.current.getContext('2d');

                    if (chartInstanceRef.current) {
                        chartInstanceRef.current.destroy();
                    }

                    chartInstanceRef.current = new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: ['5th %ile', 'Mean', '95th %ile'],
                            datasets: [
                                {
                                    label: 'GDP Impact (%)',
                                    data: [stats.gdp.p5, stats.gdp.mean, stats.gdp.p95],
                                    backgroundColor: 'rgba(59, 130, 246, 0.7)'
                                },
                                {
                                    label: 'Poverty Reduction (%)',
                                    data: [stats.poverty.p5, stats.poverty.mean, stats.poverty.p95],
                                    backgroundColor: 'rgba(34, 197, 94, 0.7)'
                                },
                                {
                                    label: 'Inflation (%)',
                                    data: [stats.inflation.p5, stats.inflation.mean, stats.inflation.p95],
                                    backgroundColor: 'rgba(239, 68, 68, 0.7)'
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            scales: {
                                y: {
                                    beginAtZero: true
                                }
                            }
                        }
                    });

                    setIsRunning(false);
                }, 500);
            };

            return (
                <div className="content-card">
                    <h2>üéØ Monte Carlo: Universal Basic Income Analysis</h2>

                    <div className="info-box">
                        <strong>Scenario:</strong> Evaluate the economic impact of a Universal Basic Income (UBI) constitutional amendment using Monte Carlo simulation with uncertain parameters.
                    </div>

                    <div className="controls">
                        <div className="control-group">
                            <label>UBI Amount ($/month): ${ubiAmount}</label>
                            <input
                                type="range"
                                min="500"
                                max="3000"
                                step="100"
                                value={ubiAmount}
                                onChange={(e) => setUbiAmount(parseInt(e.target.value))}
                            />
                        </div>
                        <div className="control-group">
                            <label>Number of Simulations: {runs}</label>
                            <input
                                type="range"
                                min="100"
                                max="10000"
                                step="100"
                                value={runs}
                                onChange={(e) => setRuns(parseInt(e.target.value))}
                            />
                        </div>
                    </div>

                    <button onClick={runSimulation} disabled={isRunning}>
                        {isRunning ? '‚è≥ Running...' : 'üé≤ Run Monte Carlo Simulation'}
                    </button>

                    {results && (
                        <>
                            <div className="visualization">
                                <canvas ref={chartRef} />
                            </div>

                            <div className="stats-grid">
                                <div className="stat-box">
                                    <span className="stat-value">{results.gdp.mean.toFixed(2)}%</span>
                                    <span className="stat-label">Mean GDP Impact</span>
                                </div>
                                <div className="stat-box">
                                    <span className="stat-value">{results.poverty.mean.toFixed(1)}%</span>
                                    <span className="stat-label">Mean Poverty Reduction</span>
                                </div>
                                <div className="stat-box">
                                    <span className="stat-value">{results.inflation.mean.toFixed(2)}%</span>
                                    <span className="stat-label">Mean Inflation</span>
                                </div>
                            </div>

                            <div className="warning-box" style={{marginTop: '20px'}}>
                                <strong>Uncertainty Range:</strong> The 5th-95th percentile range shows significant variation in outcomes. This highlights the importance of considering uncertainty in policy decisions.
                            </div>
                        </>
                    )}

                    <div className="success-box" style={{marginTop: '20px'}}>
                        <strong>Use Case:</strong> Monte Carlo is excellent for quantifying uncertainty and risk in policy outcomes, but doesn't capture behavioral dynamics or emergent phenomena.
                    </div>
                </div>
            );
        }

        // Comparison Tab
        function ComparisonTab() {
            return (
                <div className="content-card">
                    <h2>üìä Simulation Framework Comparison</h2>

                    <div className="info-box">
                        <strong>Key Takeaway:</strong> Different simulation types excel at different aspects of value discovery. Use an ensemble approach for robust results.
                    </div>

                    <table className="comparison-table">
                        <thead>
                            <tr>
                                <th>Method</th>
                                <th>Emergent Behavior</th>
                                <th>Uncertainty</th>
                                <th>Mechanisms</th>
                                <th>Scalability</th>
                                <th>Best For</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Monte Carlo</strong></td>
                                <td className="xmark">‚úó</td>
                                <td className="checkmark">‚úì‚úì‚úì</td>
                                <td className="xmark">‚úó</td>
                                <td className="checkmark">‚úì‚úì‚úì</td>
                                <td>Risk assessment</td>
                            </tr>
                            <tr>
                                <td><strong>Agent-Based</strong></td>
                                <td className="checkmark">‚úì‚úì‚úì</td>
                                <td className="checkmark">‚úì</td>
                                <td className="checkmark">‚úì‚úì</td>
                                <td className="xmark">‚úó</td>
                                <td>Value discovery</td>
                            </tr>
                            <tr>
                                <td><strong>System Dynamics</strong></td>
                                <td className="checkmark">‚úì</td>
                                <td className="checkmark">‚úì</td>
                                <td className="checkmark">‚úì‚úì‚úì</td>
                                <td className="checkmark">‚úì‚úì</td>
                                <td>Macro trends</td>
                            </tr>
                            <tr>
                                <td><strong>Multi-Agent RL</strong></td>
                                <td className="checkmark">‚úì‚úì‚úì</td>
                                <td className="xmark">‚úó</td>
                                <td className="xmark">‚úó</td>
                                <td className="xmark">‚úó</td>
                                <td>Equilibria</td>
                            </tr>
                            <tr>
                                <td><strong>Evolutionary</strong></td>
                                <td className="checkmark">‚úì</td>
                                <td className="checkmark">‚úì</td>
                                <td className="xmark">‚úó</td>
                                <td className="checkmark">‚úì‚úì</td>
                                <td>Novelty search</td>
                            </tr>
                            <tr>
                                <td><strong>Causal</strong></td>
                                <td className="xmark">‚úó</td>
                                <td className="checkmark">‚úì‚úì</td>
                                <td className="checkmark">‚úì‚úì‚úì</td>
                                <td className="checkmark">‚úì‚úì</td>
                                <td>Understanding</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3>üéØ Recommended Ensemble Stack</h3>

                    <div className="simulation-grid">
                        <div className="sim-card">
                            <div className="sim-title">Tier 1: Essential</div>
                            <div className="sim-description">
                                <strong>Agent-Based Modeling</strong> - Core simulation engine<br/>
                                <strong>Digital Twin</strong> - Real-world calibration<br/>
                                <strong>Causal Models</strong> - Mechanism understanding
                            </div>
                        </div>

                        <div className="sim-card">
                            <div className="sim-title">Tier 2: Enhanced</div>
                            <div className="sim-description">
                                <strong>Monte Carlo</strong> - Uncertainty quantification<br/>
                                <strong>System Dynamics</strong> - Macro feedback loops<br/>
                                <strong>Network Models</strong> - Value spread
                            </div>
                        </div>

                        <div className="sim-card">
                            <div className="sim-title">Tier 3: Advanced</div>
                            <div className="sim-description">
                                <strong>Multi-Agent RL</strong> - Strategic equilibria<br/>
                                <strong>Evolutionary Algorithms</strong> - Novel values<br/>
                                <strong>LLM Integration</strong> - Natural language
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        // Code Examples Tab
        function CodeExamplesTab() {
            const [selectedExample, setSelectedExample] = useState('abm');

            const examples = {
                'abm': `# Agent-Based Model: Constitutional Value Evolution

class Citizen(Agent):
    def __init__(self):
        self.values = {
            'privacy': 0.7,
            'security': 0.8,
            'freedom': 0.9
        }
        self.wealth = random.lognormal(10, 2)
        self.social_network = []

    def step(self):
        # Make decisions based on values
        if new_surveillance_law:
            self.react_to_policy()
            self.influence_neighbors()
            self.update_values()  # Values evolve!

    def update_values(self):
        # Values change based on experience
        if self.experienced_crime:
            self.values['security'] += 0.1
        if self.was_surveilled:
            self.values['privacy'] += 0.1

# Run simulation
model = ConstitutionalModel(n_citizens=1_000_000)
model.introduce_policy("surveillance_law")
model.run(years=20)`,

                'monte-carlo': `# Monte Carlo: Universal Basic Income Analysis

import numpy as np

def simulate_ubi(ubi_amount, n_runs=10000):
    outcomes = []

    for i in range(n_runs):
        # Sample uncertain parameters
        inflation = np.random.uniform(0.02, 0.15)
        labor_participation = np.random.beta(0.7, 0.3)
        productivity = np.random.normal(0.05, 0.1)

        # Economic model
        gdp_impact = (labor_participation - 0.75) * 2 + productivity
        poverty_reduction = min(40, (ubi_amount / 50) * (1 - inflation))
        final_inflation = inflation + (ubi_amount / 10000) * 0.5

        outcomes.append({
            'gdp': gdp_impact,
            'poverty': poverty_reduction,
            'inflation': final_inflation
        })

    # Calculate confidence intervals
    return {
        'gdp_mean': np.mean([o['gdp'] for o in outcomes]),
        'gdp_ci': np.percentile([o['gdp'] for o in outcomes], [5, 95]),
        'poverty_mean': np.mean([o['poverty'] for o in outcomes]),
        'inflation_mean': np.mean([o['inflation'] for o in outcomes])
    }

# Run analysis
results = simulate_ubi(ubi_amount=1000)`,

                'evolutionary': `# Evolutionary Algorithm: Constitutional Optimization

def evolve_constitution(generations=10000):
    # Start with population of constitutions
    constitutions = [random_constitution() for _ in range(1000)]

    for gen in range(generations):
        # Evaluate fitness (societal wellbeing)
        scores = [simulate_society(c) for c in constitutions]

        # Select best performers
        parents = select_top_20_percent(constitutions, scores)

        # Create next generation
        children = []
        for _ in range(1000):
            parent1, parent2 = random.choice(parents, 2)
            child = crossover(parent1, parent2)
            child = mutate(child)  # Discover NEW values!
            children.append(child)

        constitutions = children

    return best_constitution(constitutions)

def mutate(constitution):
    if random() < 0.01:
        # Add completely new right!
        new_right = generate_novel_right()
        constitution.add(new_right)
    return constitution`,

                'digital-twin': `# Digital Twin Society: Full Stack

class DigitalTwinUSA:
    def __init__(self):
        # Real demographic data
        self.population = load_census_data()
        self.economy = load_economic_structure()
        self.social_networks = load_network_topology()

    def add_constitutional_right(self, right_name):
        """Test new constitutional amendment"""
        self.constitution.append(right_name)

    def run_ensemble_simulation(self, years=50):
        """Run multiple simulation types"""
        results = {
            'abm': self.agent_based_sim(years),
            'system_dynamics': self.macro_sim(years),
            'monte_carlo': self.uncertainty_analysis(years),
            'rl': self.strategic_actors_sim(years)
        }

        return self.aggregate_forecasts(results)

# Example: Test "Right to Algorithmic Explanation"
digital_twin = DigitalTwinUSA()
digital_twin.add_constitutional_right("algorithmic_explanation")
outcomes = digital_twin.run_ensemble_simulation(years=20)

print(f"Predicted impact: {outcomes.summary()}")`,

                'causal': `# Causal Inference: Constitutional Mechanisms

from dowhy import CausalModel

# Define causal structure
causal_model = CausalModel(
    data=historical_data,
    treatment='privacy_right',
    outcome='social_trust',
    common_causes=['wealth', 'education'],
    instruments=['constitution_year']
)

# Identify causal effect
identified = causal_model.identify_effect()

# Estimate
estimate = causal_model.estimate_effect(
    identified,
    method_name="backdoor.propensity_score_matching"
)

# Counterfactual: What if we added privacy right in 1789?
counterfactual = causal_model.refute_estimate(
    identified,
    estimate,
    method_name="placebo_treatment_refuter"
)

print(f"Causal effect of privacy right: {estimate.value}")
print(f"95% CI: {estimate.confidence_intervals}")`
            };

            return (
                <div className="content-card">
                    <h2>üíª Implementation Examples</h2>

                    <div className="controls">
                        <div className="control-group">
                            <label>Select Example</label>
                            <select value={selectedExample} onChange={(e) => setSelectedExample(e.target.value)}>
                                <option value="abm">Agent-Based Model</option>
                                <option value="monte-carlo">Monte Carlo Simulation</option>
                                <option value="evolutionary">Evolutionary Algorithm</option>
                                <option value="digital-twin">Digital Twin Society</option>
                                <option value="causal">Causal Inference</option>
                            </select>
                        </div>
                    </div>

                    <div className="code-block">
                        <pre>{examples[selectedExample]}</pre>
                    </div>

                    <div className="success-box" style={{marginTop: '20px'}}>
                        <strong>Next Steps:</strong> These examples show the core structure. For production use, add error handling, validation, visualization, and rigorous testing.
                    </div>

                    <h3>üìö Recommended Libraries</h3>

                    <div className="simulation-grid">
                        <div className="sim-card">
                            <div className="sim-title">Python ABM</div>
                            <div className="sim-description">
                                <strong>Mesa</strong> - Agent-based modeling framework<br/>
                                <strong>NetworkX</strong> - Social network analysis<br/>
                                <strong>NumPy/SciPy</strong> - Numerical computing
                            </div>
                        </div>

                        <div className="sim-card">
                            <div className="sim-title">Machine Learning</div>
                            <div className="sim-description">
                                <strong>PyTorch/TensorFlow</strong> - Multi-agent RL<br/>
                                <strong>DEAP</strong> - Evolutionary algorithms<br/>
                                <strong>Stable-Baselines3</strong> - RL agents
                            </div>
                        </div>

                        <div className="sim-card">
                            <div className="sim-title">Causal & Stats</div>
                            <div className="sim-description">
                                <strong>DoWhy</strong> - Causal inference<br/>
                                <strong>PyMC</strong> - Bayesian modeling<br/>
                                <strong>Statsmodels</strong> - Statistical analysis
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        // Render the app
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
